---
title: "DATA 624 | Predictive Analytics"
author: "Gehad Gad, Karim Hammoud, Gabriella Martinez"
date: "`r Sys.Date()`"
output:
      html_document:
        toc: yes
        toc_float: yes
        theme: yeti
        highlight: kate
        font-family: "Arial"
        code_folding: hide
---

# Project 2
## Instructions

This is role playing.  I am your new boss.  I am in charge of production at ABC Beverage and you are a team of data scientists reporting to me.  My leadership has told me that new regulations are requiring us to understand our manufacturing process, the **predictive factors and be able to report to them our predictive model of PH.**  

Please use the historical data set I am providing. Build and report the factors in BOTH a technical and non-technical report.  I like to use Word and Excel.  Please provide your non-technical report in a business friendly readable document and your predictions in an Excel readable format. The technical report should show clearly the models you tested and how you selected your final approach.  

Please submit both Rpubs links and .rmd files or other readable formats for technical and non-technical reports.  Also submit the excel file showing the prediction of your models for pH.

## Packages
```{r message=FALSE, warning=FALSE, class.source = 'fold-show'}
library(openxlsx)
library(DataExplorer)
library(summarytools)
library(dplyr)
library(forecast)
library(ggplot2)
library(tidyr)
library(mice)
library(corrplot)
library(MASS)
library(earth)
library(RANN)
```

#### Train
```{r}
#load data
train <- read.xlsx("TrainingData.xlsx")
#review
glimpse(train)
```

NAs in Train data set 
```{r}
#NA counts by column
sapply(train, function(x) sum(is.na(x)))
```

```{r message=FALSE, warning=FALSE, include=FALSE}
print(dfSummary(train), file = '~/train_summary.html')
```
[`train` Summary Statistics](https://htmlpreview.github.io/?https://github.com/gabbypaola/DATA624/blob/main/Project%202/train_summary.html) 

```{r}
DataExplorer::plot_histogram(train, nrow = 3L, ncol = 4L)
```

```{r}
stats <- descr(train,
  headings = FALSE, #remove headings
  stats = "common",# most common descriptive statistics, default is all
  transpose = TRUE #allows for better display due to large amount of variables
  )
dfstats <- as.data.frame.matrix(stats)

dfstats$rightskew <- dfstats$Mean > dfstats$Median
dfstats$rightamount <- round(dfstats$Mean - dfstats$Median, 4)

dfstats$leftskew <- dfstats$Mean < dfstats$Median
dfstats$leftamount <- round(dfstats$Median- dfstats$Mean , 4)
```

```{r}
dfstats
```

From the above, variables in the training data set exhibit the follow skews in distribution:

- normal:  `Carb.Pressure`, `Carb.Temp`, `Fill.Ounces`, `PC.Volume`, `PH` (response variable)

- left-skew:  `Carb.Flow`, `Filler.Speed`, `Mnf.Flow`, `MFR`, `Bowl.Setpoint`, `Filler.Level`, `Hyd.Pressure2`, `Hyd.Pressure3`, `Usage.cont`, `Carb.Pressure1`, `Filler.Speed`

- right-skew: `Pressure.Setpoint`, `Fill.Pressure`, `Hyd.Pressure1`, `Temperature`, `Carb.Volume`, `PSC`, `PSC.CO2`, `PSC.Fill`, `Balling`, `Density`, `Hyd.Pressure4`, `Air.Pressurer`, `Alch.Rel`, `Carb.Rel`, `Oxygen.Filler`, `Balling.Lvl`, `Pressure.Vacuum`

#### Test
```{r}
#load data
test <- read.xlsx("TestData.xlsx")
#review 
glimpse(test)
```
NAs in Test data set 
```{r}
#NA counts by column
sapply(test, function(x) sum(is.na(x)))
```

```{r message=FALSE, warning=FALSE, include=FALSE}
print(dfSummary(test), file = '~/test_summary.html')
```
[`test` Summary Statistics](https://htmlpreview.github.io/?https://github.com/gabbypaola/DATA624/blob/main/Project%202/test_summary.html) 

## Exploratory Data Analysis

## Models


<!------- Below is for removing excessive space in Rmarkdown | HTML formatting -------->

<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div>